@model IEnumerable<RestaurantManager.Models.Table>
@{
    ViewData["Title"] = "Mapa Stolików";
    List<int> busyTableIds = ViewBag.BusyTableIds as List<int> ?? new List<int>();
}

<div class="container mt-4 mb-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="fw-bold text-dark mb-0">Mapa Stolików</h2>
            <p class="text-muted small mb-0">Wybierz stolik, aby obsłużyć zamówienie</p>
        </div>
        <a asp-action="Index" class="btn btn-outline-secondary rounded-pill px-4 fw-medium">
            <i class="bi bi-arrow-left me-2"></i> Wróć do listy
        </a>
    </div>

    <div class="row g-4">
        @foreach (var table in Model)
        {
            bool isBusy = busyTableIds.Contains(table.Id);

            string bgClass = isBusy ? "bg-danger text-white" : "bg-success text-white";
            string textClass = "text-white-50";

            string statusIcon = isBusy ? "bi-person-fill" : "bi-check-lg";
            string statusText = isBusy ? "ZAJĘTY" : "WOLNY";

            string badgeClass = isBusy ? "bg-white text-danger" : "bg-white text-success";

            <div class="col-6 col-md-4 col-lg-3">
                <a asp-action="ManageTable" asp-route-id="@table.Id" class="text-decoration-none card-lift-wrapper">
                    <div class="card h-100 shadow-sm rounded-4 overflow-hidden @bgClass transition-all border-0">
                        <div class="card-body d-flex flex-column justify-content-center align-items-center text-center py-5">
                            <h3 class="display-6 fw-bold mb-1 text-white">@table.Name</h3>
                            <p class="@textClass mb-3 small"><i class="bi bi-people-fill me-1"></i> @table.Capacity os.</p>
                            <span class="badge @badgeClass px-3 py-2 rounded-pill shadow-sm fw-bold">
                                <i class="bi @statusIcon me-1"></i> @statusText
                            </span>
                        </div>
                    </div>
                </a>
            </div>
        }
    </div>
</div>

<style>
    .transition-all {
        transition: all 0.3s ease;
    }

    .card-lift-wrapper:hover .card {
        transform: translateY(-5px);
        box-shadow: 0 1rem 3rem rgba(0,0,0,.25) !important;
    }
</style>