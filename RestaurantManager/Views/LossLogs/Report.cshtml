@model RestaurantManager.Models.LossLog

@{
    ViewData["Title"] = "Zgłoś Stratę";
}

<div class="container mt-5 mb-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card shadow-sm border-0 rounded-4 overflow-hidden border-top border-4 border-danger">
                <div class="card-header bg-white py-3 border-bottom-0 text-center">
                    <h4 class="mb-0 fw-bold text-danger"><i class="bi bi-trash3-fill me-2"></i>Zgłoś Stratę</h4>
                    <p class="text-muted small mb-0 mt-1">Wypełnij formularz, aby zarejestrować odpad lub uszkodzenie.</p>
                </div>

                <div class="card-body p-4 bg-light bg-opacity-25">
                    <form asp-action="Report" method="post" id="reportForm">
                        @Html.AntiForgeryToken()
                        <div asp-validation-summary="All" class="alert alert-danger shadow-sm border-0 rounded-3 small" role="alert" data-valmsg-summary="true"></div>

                        <div class="mb-4 text-center">
                            <label class="form-label d-block fw-bold small text-uppercase text-muted ls-1 mb-3">Co zostało utracone?</label>
                            <div class="btn-group w-100 shadow-sm rounded-pill" role="group">
                                <input type="radio" class="btn-check" name="itemSource" id="sourceMenu" value="menu" checked onchange="toggleSource()">
                                <label class="btn btn-white border px-4 py-2 fw-medium rounded-start-pill" for="sourceMenu">
                                    <i class="bi bi-egg-fried me-2 text-primary"></i>Pozycja Menu
                                </label>

                                <input type="radio" class="btn-check" name="itemSource" id="sourceCustom" value="custom" onchange="toggleSource()">
                                <label class="btn btn-white border px-4 py-2 fw-medium rounded-end-pill" for="sourceCustom">
                                    <i class="bi bi-box-seam me-2 text-secondary"></i>Inne / Sprzęt
                                </label>
                            </div>
                        </div>

                        <div id="menuSection" class="bg-white p-3 rounded-3 border mb-3">
                            <div class="mb-0">
                                <label asp-for="MenuItemId" class="form-label fw-bold small">Wybierz danie z listy</label>
                                <select asp-for="MenuItemId" class="form-select bg-light border-0" asp-items="ViewBag.MenuItems">
                                    <option value="" selected disabled>-- Wybierz --</option>
                                </select>
                                <span asp-validation-for="MenuItemId" class="text-danger small"></span>
                            </div>
                        </div>

                        <div id="customSection" class="bg-white p-3 rounded-3 border mb-3" style="display:none;">
                            <div class="mb-3">
                                <label asp-for="CustomItemName" class="form-label fw-bold small">Nazwa przedmiotu</label>
                                <input asp-for="CustomItemName" class="form-control bg-light border-0" placeholder="np. Talerz głęboki, Szklanka" />
                                <span asp-validation-for="CustomItemName" class="text-danger small"></span>
                            </div>
                            <div class="mb-0">
                                <label asp-for="CustomItemCost" class="form-label fw-bold small">Koszt jednostkowy (PLN)</label>
                                <input asp-for="CustomItemCost" class="form-control bg-light border-0" type="number" step="0.01" />
                                <div class="form-text small">Jaki jest koszt zakupu jednej sztuki?</div>
                                <span asp-validation-for="CustomItemCost" class="text-danger small"></span>
                            </div>
                        </div>

                        <hr class="my-4 text-muted opacity-25">

                        <div class="row g-3 mb-3">
                            <div class="col-md-4">
                                <label asp-for="Quantity" class="form-label fw-bold small text-uppercase text-muted ls-1">Ilość</label>
                                <input asp-for="Quantity" class="form-control text-center fw-bold rounded-3" type="number" min="1" value="1" />
                                <span asp-validation-for="Quantity" class="text-danger small"></span>
                            </div>
                            <div class="col-md-8">
                                <label asp-for="LossType" class="form-label fw-bold small text-uppercase text-muted ls-1">Przyczyna</label>
                                <select asp-for="LossType" class="form-select rounded-3">
                                    <option value="">-- Wybierz powód --</option>
                                    <option value="Uszkodzenie">Uszkodzenie (np. stłuczka)</option>
                                    <option value="Zepsucie">Zepsucie (np. przeterminowane)</option>
                                    <option value="Odpady">Odpady produkcyjne / Błąd kuchni</option>
                                    <option value="Reklamacja">Zwrot od klienta</option>
                                    <option value="Kradzież">Kradzież</option>
                                    <option value="Inne">Inne</option>
                                </select>
                                <span asp-validation-for="LossType" class="text-danger small"></span>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label asp-for="Description" class="form-label fw-bold small text-uppercase text-muted ls-1">Opis sytuacji</label>
                            <textarea asp-for="Description" class="form-control rounded-3" rows="3" placeholder="Dodaj szczegóły..."></textarea>
                            <span asp-validation-for="Description" class="text-danger small"></span>
                        </div>

                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-danger btn-lg rounded-pill fw-bold shadow-sm">
                                <i class="bi bi-check-lg me-2"></i>Zarejestruj Stratę
                            </button>
                            <a asp-controller="Home" asp-action="Index" class="btn btn-link text-muted text-decoration-none small">Anuluj i wróć</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function toggleSource() {
        var isMenu = document.getElementById('sourceMenu').checked;
        var menuSection = document.getElementById('menuSection');
        var customSection = document.getElementById('customSection');

        if (isMenu) {
            menuSection.style.display = 'block';
            customSection.style.display = 'none';
        } else {
            menuSection.style.display = 'none';
            customSection.style.display = 'block';
        }
    }
</script>

<style>
    .btn-check:checked + .btn-white {
        background-color: #f8f9fa;
        border-color: #dee2e6;
        color: #212529;
        box-shadow: inset 0 3px 5px rgba(0,0,0,0.125);
    }
</style>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}