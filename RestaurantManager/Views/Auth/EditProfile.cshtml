@model RestaurantManager.ViewModels.ProfileViewModel

@{
    ViewData["Title"] = "Edytuj Profil";
}

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card shadow border-0 rounded-4 overflow-hidden">
                <div class="card-header bg-white py-3 border-bottom-0">
                    <h4 class="mb-0 fw-bold text-dark"><i class="bi bi-person-gear me-2"></i>Edytuj Profil</h4>
                </div>

                <div class="card-body p-4 bg-light bg-opacity-25">
                    <form asp-action="EditProfile" asp-controller="Auth" method="post" enctype="multipart/form-data">
                        <input asp-for="Username" type="hidden" />

                        @if (!ViewData.ModelState.IsValid)
                        {
                            <div class="alert alert-danger border-0 rounded-3 shadow-sm mb-4">
                                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                            </div>
                        }

                        <div class="bg-white p-3 rounded-3 shadow-sm mb-4 border">
                            <div class="row align-items-center">
                                <div class="col-auto">
                                    @if (!string.IsNullOrEmpty(Model.ProfilePicturePath))
                                    {
                                        <img src="@Model.ProfilePicturePath" class="rounded-circle" style="width:80px; height:80px; object-fit:cover;" />
                                    }
                                    else
                                    {
                                        <img src="/images/profiles/default.png" class="rounded-circle" style="width:80px; height:80px; object-fit:cover;" />
                                    }
                                </div>
                                <div class="col">
                                    <label asp-for="ProfileImage" class="form-label fw-bold small text-uppercase ls-1">Zmień zdjęcie</label>
                                    <input asp-for="ProfileImage" class="form-control" type="file" accept="image/*" />
                                    <span asp-validation-for="ProfileImage" class="text-danger small"></span>
                                </div>
                            </div>
                        </div>

                        <div class="form-floating mb-3">
                            <input asp-for="Email" class="form-control" placeholder="name@example.com" />
                            <label asp-for="Email">Adres Email</label>
                            <span asp-validation-for="Email" class="text-danger small"></span>
                        </div>

                        <div class="form-floating mb-4">
                            <input asp-for="PhoneNumber" class="form-control" placeholder="Telefon" />
                            <label asp-for="PhoneNumber">Telefon kontaktowy</label>
                            <span asp-validation-for="PhoneNumber" class="text-danger small"></span>
                        </div>

                        <div class="accordion mb-4" id="passwordAccordion">
                            <div class="accordion-item border-0 shadow-sm rounded-3 overflow-hidden">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed fw-bold text-muted bg-white" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePassword">
                                        <i class="bi bi-shield-lock me-2"></i> Zmiana hasła (opcjonalnie)
                                    </button>
                                </h2>
                                <div id="collapsePassword" class="accordion-collapse collapse" data-bs-parent="#passwordAccordion">
                                    <div class="accordion-body bg-white">
                                        <div class="mb-3">
                                            <label asp-for="OldPassword" class="form-label small fw-bold">Obecne hasło</label>
                                            <input asp-for="OldPassword" class="form-control" type="password" />
                                            <span asp-validation-for="OldPassword" class="text-danger small"></span>
                                        </div>
                                        <div class="row g-2">
                                            <div class="col-md-6">
                                                <label asp-for="NewPassword" class="form-label small fw-bold">Nowe hasło</label>
                                                <input asp-for="NewPassword" class="form-control" type="password" />
                                                <span asp-validation-for="NewPassword" class="text-danger small"></span>
                                            </div>
                                            <div class="col-md-6">
                                                <label asp-for="ConfirmPassword" class="form-label small fw-bold">Powtórz nowe</label>
                                                <input asp-for="ConfirmPassword" class="form-control" type="password" />
                                                <span asp-validation-for="ConfirmPassword" class="text-danger small"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a asp-action="Profile" class="btn btn-light border px-4 fw-medium">Anuluj</a>
                            <button type="submit" class="btn btn-primary px-4 fw-bold shadow-sm">Zapisz zmiany</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}